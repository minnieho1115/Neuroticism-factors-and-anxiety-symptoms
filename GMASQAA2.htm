LIBNAME IN 'C:\Users\Administrator\Desktop\yaodata\changsha';

DATA TEMPX; SET IN.data1;
KEEP ID Gender G ZSHS_TOT_I MASQ_AA_I;

PROC SORT; BY ID;
RUN;

PROC STANDARD DATA=TEMPX OUT=STDTEMPX MEAN=0 STD=1;
VAR MASQ_AA_I G;
RUN;

PROC SORT; BY ID;
RUN;

DATA FU0; SET IN.data1;
KEEP ID TIME MASQ_AA_I ZSHS_TOT_I;
TIME = 0;

RENAME MASQ_AA_I= CESDRESSION;
RENAME ZSHS_TOT_I = STRESS;

PROC SORT; BY ID;
RUN;
DATA FU1; SET IN.data1;
KEEP ID TIME MASQ_AA_1 ZSHS_TOT_1;
TIME = 1;


RENAME MASQ_AA_1 = CESDRESSION;
RENAME ZSHS_TOT_1 = STRESS;
 


PROC SORT; BY ID;
RUN;
DATA FU2; SET IN.data1;
KEEP ID TIME MASQ_AA_2 ZSHS_TOT_2;
TIME = 2;


RENAME MASQ_AA_2 = CESDRESSION;
RENAME ZSHS_TOT_2 = STRESS;



PROC SORT; BY ID;
RUN;

DATA FU3; SET IN.data1;
KEEP ID TIME MASQ_AA_3 ZSHS_TOT_3;
TIME = 3;


RENAME MASQ_AA_3 = CESDRESSION;
RENAME ZSHS_TOT_3 = STRESS;
 


PROC SORT; BY ID;
RUN;
DATA FU4; SET IN.data1;
KEEP ID TIME MASQ_AA_4 ZSHS_TOT_4;
TIME = 4;


RENAME MASQ_AA_4 = CESDRESSION;
RENAME ZSHS_TOT_4 = STRESS;
 


PROC SORT; BY ID;
RUN;
DATA FU5; SET IN.data1;
KEEP ID TIME MASQ_AA_5 ZSHS_TOT_5;
TIME = 5;


RENAME MASQ_AA_5 = CESDRESSION;
RENAME ZSHS_TOT_5 = STRESS;
 


PROC SORT; BY ID;
RUN;
DATA FU6; SET IN.data1;
KEEP ID TIME MASQ_AA_6 ZSHS_TOT_6;
TIME = 6;


RENAME MASQ_AA_6 = CESDRESSION;
RENAME ZSHS_TOT_6 = STRESS;
 


PROC SORT; BY ID;
RUN;
DATA TEMPY; MERGE FU1 FU2 FU3 FU4 FU5 FU6; BY ID TIME;

PROC SORT; BY ID TIME;
RUN;

DATA TEMPZ; MERGE STDTEMPX TEMPY; BY ID;

IF CESDRESSION = . THEN DELETE;
IF STRESS = . THEN DELETE;

PROC SORT; BY ID TIME;
RUN;

PROC MEANS MEAN DATA=TEMPZ NOPRINT; BY ID;
  VAR CESDRESSION STRESS;
  OUTPUT OUT=TOTAL MEAN= MN_CESDRESSION MN_STRESS;
RUN;

PROC STANDARD DATA=TOTAL MEAN=0 STD=1 OUT=STDTOTAL;
  VAR MN_CESDRESSION MN_STRESS;
RUN;

DATA FINAL; MERGE TEMPZ STDTOTAL; BY ID;

PROC STANDARD MEAN=0 DATA=FINAL OUT=FINALY; BY ID;
  VAR STRESS;
RUN;


PROC MIXED NOCLPRINT METHOD=ML COVTEST NOITPRINT;
  CLASS ID TIME;
  MODEL  CESDRESSION = Gender MASQ_AA_I  STRESS G STRESS*G
 	     /SOLUTION DDFM=BW; 
  RANDOM  INTERCEPT STRESS/SUB=ID TYPE=UN;
  repeated time /type=ARH(1) subject=id rcorr;


estimate 'mean slope' STRESS 1 ;
estimate 'slope for high G' STRESS 1 G*STRESS 1.5;
estimate 'slope for low G' STRESS 1 G*STRESS -1.5;
estimate 'slope h vs slope l'   G*STRESS 3;



estimate ' h G, high STRESS' int 1 MASQ_AA_I .48  STRESS 0.48  G 1.5 
G*STRESS 0.72;
estimate ' h G, low STRESS'  int 1 MASQ_AA_I .48 STRESS -0.48 G 1.5 
G*STRESS -0.72;
estimate ' l G, high STRESS' int 1 MASQ_AA_I -.47 STRESS 0.48 G -1.5 
G*STRESS -0.72;
estimate ' l G, low STRESS'  int 1 MASQ_AA_I -.47 STRESS -0.48 G -1.5 
G*STRESS 0.72;

RUN;

	


